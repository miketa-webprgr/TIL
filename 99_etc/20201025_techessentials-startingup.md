# TechEssentialsで開発を始める上でのTips

## はじめに

TechEssentialsで開発してみたいけど、なんかいきなり動かない。  
テンション、マヂで下がる。。。  

という女子高生に向けた、とりあえず動かすための色々な知見。  

みけたの我流なので、だいそんさんに注意されそうなものもありそうですが、  
とりあえず、動かして挙動を確かめないことには始まらない！  

## とりあえず、管理者・一般ユーザーとしてログインしたいんだけど。。。  

### TechEssentialsのログインしようについて

まず、仕様のところから確認しましょう。  

TechEssentialsなんですが、よくありがちなアプリとは異なり、メールアドレス + パスワードでのログイン機能がありません。  
ユーザー目線からすれば、この辺りの設定作業は面倒なので、だいそんさんがそうした経緯についてはよく分かります。  
（あとは、馬鹿みたいにたくさんのユーザーを作られないためにそうしているのかもしれません）  

なので、rails consoleでユーザーを適当に作って、ログイン画面からメールアドレス + パスワードでログイン！！！  
っていうのができません。TwitterかGithubアカウントでログインする仕組みとなっています。  

私もまだよく分かっていないですが、ユーザーを作成の上、該当のユーザーで`localhost:3000/login_as/:user_id`に
アクセスすると、ログインできる仕様になっているみたいです。  

### ログインするまでの手順

まあ、まずはともあれ、データベースの作成とマイグレーションの実行をしましょう！  

```text
bundle exec rails db:create
bundle exec rails db:migrate
```

そして、シードファイルを実行してあげましょう。  
シードファイルを実行すると、一般ユーザーを10人作成し、管理者ユーザーを1人作成してくれます。  

```text
bundle exec rails db:seed
```

すると、私はエラーになりました。。。  
`db/seeds/quizzes.rb`に問題があるようで、`create_quiz!`というメソッドが定義されていないようです。。。（2020/10/25時点）  

困っただいそんさんです。。。  
これは、とりあえず困ったときに使えるテクニックですが、とりあえずエラーが起きたらコメントアウトしましょう！笑  

本当は、思考停止でコメントアウトしまくるのはマズいんですが、  
影響範囲について少し考えた上で、それを頭の片隅におきつつ、やってみるのはありです。  

さて、シードファイルを実行した上で、コンソールを立ち上げて、admin権限が付与されているUserを確認しましょう。  

```text
bundle exec rails c
User.find_by(role: "admin")
```

ここで、取得できたuserのidを確認しましょう。  
このidが仮に1番だとすると、`localhost:3000/login_as/1`で管理者としてアクセスできます。  

ログインした後、`localhost:3000/admin`にアクセスすると、管理者用のダッシュボードが開きます。  

なお、一般ユーザーとして試したい場合、`role: "general"`となっているユーザーのidを確認してください。  
このidが仮に2番だとすると、`localhost:3000/login_as/2`で一般ユーザーとしてアクセスできます。  

ログインした後、一般ユーザーなので、`localhost:3000/admin`にアクセスできないはずです。  

## 動画投稿関係の仕様について

とりあえず、雑に把握したことをぺたぺた貼っていく。  
2020/10/25時点です。  

携わる人が増えれば、だいそんさんが改良してくれるかも。  
それか、うざくて耐えられない人が改良するというチキンゲームになるかも笑

- タグの部分は日本語入力がうまくできない
  - 日本語入力する場合、他のところで日本語で記入してコピペしないといけない
- 編集画面において空欄のタグが表示されちゃってうまく更新できない
  - 登録時になぜか空欄のタグが生成される仕様となっている
  - いったん空欄のタグを消すと、更新できる
- 動画のsourceには、iframeのHTMLソース自体を入力する
  - 例: `<iframe src="https://drive.google.com/file/d/1iig_-sptxGbS7ebe1redEZt1S1nl3YVw/preview"></iframe>`
- 削除機能がまだない